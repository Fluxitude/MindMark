var content=function(){"use strict";var M=Object.defineProperty;var k=(u,c,l)=>c in u?M(u,c,{enumerable:!0,configurable:!0,writable:!0,value:l}):u[c]=l;var d=(u,c,l)=>k(u,typeof c!="symbol"?c+"":c,l);var w,S;function u(r){return r}const c={matches:["https://*/*","http://*/*"],main(){console.log("MindMark content script loaded on:",window.location.href),document.addEventListener("keydown",i=>{(i.ctrlKey||i.metaKey)&&i.shiftKey&&i.key==="M"&&(i.preventDefault(),r())});function r(){const i={url:window.location.href,title:document.title,favicon:e(),selectedText:t(),metadata:n()};chrome.runtime.sendMessage({type:"SAVE_BOOKMARK",bookmark:i},o=>{o!=null&&o.success?s("Bookmark saved successfully!"):s("Failed to save bookmark","error")})}function e(){const i=document.querySelector('link[rel="icon"]')||document.querySelector('link[rel="shortcut icon"]')||document.querySelector('link[rel="apple-touch-icon"]');return i!=null&&i.href?i.href:`${window.location.origin}/favicon.ico`}function t(){var i;return((i=window.getSelection())==null?void 0:i.toString().trim())||""}function n(){const i=o=>{const a=document.querySelector(`meta[name="${o}"]`)||document.querySelector(`meta[property="${o}"]`);return a==null?void 0:a.content};return{description:i("description")||i("og:description"),author:i("author"),keywords:i("keywords"),publishedTime:i("article:published_time"),modifiedTime:i("article:modified_time"),siteName:i("og:site_name"),type:i("og:type"),image:i("og:image"),wordCount:document.body.innerText.trim().split(/\s+/).length,language:document.documentElement.lang||"en"}}function s(i,o="success"){const a=document.createElement("div");a.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${o==="success"?"#000000":"#dc3545"};
        color: white;
        padding: 12px 16px;
        border-radius: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 14px;
        font-weight: 500;
        z-index: 10000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        max-width: 300px;
        word-wrap: break-word;
      `,a.textContent=i,document.body.appendChild(a),setTimeout(()=>{a.parentNode&&a.parentNode.removeChild(a)},3e3)}chrome.runtime.onMessage.addListener((i,o,a)=>{i.type==="GET_PAGE_INFO"&&a({url:window.location.href,title:document.title,favicon:e(),selectedText:t(),metadata:n()})})}},l=((S=(w=globalThis.browser)==null?void 0:w.runtime)==null?void 0:S.id)==null?globalThis.chrome:globalThis.browser;function p(r,...e){}const v={debug:(...r)=>p(console.debug,...r),log:(...r)=>p(console.log,...r),warn:(...r)=>p(console.warn,...r),error:(...r)=>p(console.error,...r)},f=class f extends Event{constructor(e,t){super(f.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=t}};d(f,"EVENT_NAME",y("wxt:locationchange"));let g=f;function y(r){var e;return`${(e=l==null?void 0:l.runtime)==null?void 0:e.id}:content:${r}`}function E(r){let e,t;return{run(){e==null&&(t=new URL(location.href),e=r.setInterval(()=>{let n=new URL(location.href);n.href!==t.href&&(window.dispatchEvent(new g(n,t)),t=n)},1e3))}}}const h=class h{constructor(e,t){d(this,"isTopFrame",window.self===window.top);d(this,"abortController");d(this,"locationWatcher",E(this));d(this,"receivedMessageIds",new Set);this.contentScriptName=e,this.options=t,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return l.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,t){const n=setInterval(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(e,t){const n=setTimeout(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(e){const t=requestAnimationFrame((...n)=>{this.isValid&&e(...n)});return this.onInvalidated(()=>cancelAnimationFrame(t)),t}requestIdleCallback(e,t){const n=requestIdleCallback((...s)=>{this.signal.aborted||e(...s)},t);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(e,t,n,s){var i;t==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(i=e.addEventListener)==null||i.call(e,t.startsWith("wxt:")?y(t):t,n,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),v.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:h.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){var i,o,a;const t=((i=e.data)==null?void 0:i.type)===h.SCRIPT_STARTED_MESSAGE_TYPE,n=((o=e.data)==null?void 0:o.contentScriptName)===this.contentScriptName,s=!this.receivedMessageIds.has((a=e.data)==null?void 0:a.messageId);return t&&n&&s}listenForNewerScripts(e){let t=!0;const n=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const i=t;if(t=!1,i&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}};d(h,"SCRIPT_STARTED_MESSAGE_TYPE",y("wxt:content-script-started"));let b=h;const T=Symbol("null");let K=0;class _ extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[e]=arguments;if(e!=null){if(typeof e[Symbol.iterator]!="function")throw new TypeError(typeof e+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[t,n]of e)this.set(t,n)}}_getPublicKeys(e,t=!1){if(!Array.isArray(e))throw new TypeError("The keys parameter must be an array");const n=this._getPrivateKey(e,t);let s;return n&&this._publicKeys.has(n)?s=this._publicKeys.get(n):t&&(s=[...e],this._publicKeys.set(n,s)),{privateKey:n,publicKey:s}}_getPrivateKey(e,t=!1){const n=[];for(let s of e){s===null&&(s=T);const i=typeof s=="object"||typeof s=="function"?"_objectHashes":typeof s=="symbol"?"_symbolHashes":!1;if(!i)n.push(s);else if(this[i].has(s))n.push(this[i].get(s));else if(t){const o=`@@mkm-ref-${K++}@@`;this[i].set(s,o),n.push(o)}else return!1}return JSON.stringify(n)}set(e,t){const{publicKey:n}=this._getPublicKeys(e,!0);return super.set(n,t)}get(e){const{publicKey:t}=this._getPublicKeys(e);return super.get(t)}has(e){const{publicKey:t}=this._getPublicKeys(e);return super.has(t)}delete(e){const{publicKey:t,privateKey:n}=this._getPublicKeys(e);return!!(t&&super.delete(t)&&this._publicKeys.delete(n))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}new _;function x(){}function m(r,...e){}const I={debug:(...r)=>m(console.debug,...r),log:(...r)=>m(console.log,...r),warn:(...r)=>m(console.warn,...r),error:(...r)=>m(console.error,...r)};return(async()=>{try{const{main:r,...e}=c,t=new b("content",e);return await r(t)}catch(r){throw I.error('The content script "content" crashed on startup!',r),r}})()}();
content;
